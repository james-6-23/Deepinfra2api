# DeepInfra API 代理环境配置
# 复制此文件为 .env 并根据需要修改

# 服务配置
PORT=8000
DOMAIN=deepinfra.kyx03.de

# Docker 容器配置
BACKEND_HOST=deepinfra-proxy
BACKEND_PORT=8000
NGINX_PORT=80

# API Key 配置（逗号分隔多个key）
VALID_API_KEYS=linux.do

# 多端点配置（可选，逗号分隔）
# 启用多端点可以提高可用性和稳定性
# DEEPINFRA_MIRRORS=https://api.deepinfra.com/v1/openai/chat/completions,https://api1.deepinfra.com/v1/openai/chat/completions,https://api2.deepinfra.com/v1/openai/chat/completions

# 性能与安全平衡配置
PERFORMANCE_MODE=balanced  # 选项: fast, balanced, secure

# 快速模式配置 (PERFORMANCE_MODE=fast)
# MAX_RETRIES=1
# RETRY_DELAY=200
# REQUEST_TIMEOUT=10000
# RANDOM_DELAY_MIN=0
# RANDOM_DELAY_MAX=100

# 平衡模式配置 (PERFORMANCE_MODE=balanced) - 默认
MAX_RETRIES=3
RETRY_DELAY=1000
REQUEST_TIMEOUT=120000  # 增加到 2 分钟，避免长响应被截断
RANDOM_DELAY_MIN=100
RANDOM_DELAY_MAX=500

# 流处理优化配置
STREAM_BUFFER_SIZE=16384  # 16KB 缓冲区，提高流处理性能
DISABLE_CONNECTION_CHECK=false  # 智能连接检测，平衡性能和稳定性
STREAM_TIMEOUT=300000  # 流式响应专用超时：5 分钟

# 高并发优化配置
MAX_CONCURRENT_CONNECTIONS=1000  # 最大并发连接数
CONNECTION_QUEUE_SIZE=500        # 连接队列大小
MAX_CONNECTION_TIME=600000       # 单连接最大时间：10分钟
MEMORY_LIMIT_MB=2048            # 内存使用限制：2GB
ENABLE_CONNECTION_POOLING=true   # 启用连接池管理

# 分级超时配置
SHORT_RESPONSE_TIMEOUT=30000     # 短响应超时：30秒
MEDIUM_RESPONSE_TIMEOUT=120000   # 中等响应超时：2分钟
LONG_RESPONSE_TIMEOUT=300000     # 长响应超时：5分钟

# 监控和告警
ENABLE_METRICS=true              # 启用性能监控
ALERT_MEMORY_THRESHOLD=80        # 内存告警阈值：80%
ALERT_CONNECTION_THRESHOLD=90    # 连接数告警阈值：90%

# 安全模式配置 (PERFORMANCE_MODE=secure)
# MAX_RETRIES=5
# RETRY_DELAY=2000
# REQUEST_TIMEOUT=60000
# RANDOM_DELAY_MIN=500
# RANDOM_DELAY_MAX=1500

# 代理配置（可选）
# HTTP_PROXY=http://deepinfra-warp:1080
# HTTPS_PROXY=http://deepinfra-warp:1080

# WARP 配置（可选）
WARP_ENABLED=true
# WARP_LICENSE_KEY=your-warp-plus-key

